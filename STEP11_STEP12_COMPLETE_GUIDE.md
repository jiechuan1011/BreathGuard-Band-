# 糖尿病初筛监测系统 - Step 11 & 12 完整指南

## 项目完成度

- ✅ **Step 1-7**: 代码结构确认与基础框架
- ✅ **Step 8**: 最终联调版本代码
- ✅ **Step 9**: 烧录与测试流程
- ✅ **Step 10**: MIT App Inventor 方案设计
- ✅ **Step 11**: 单板测试检查点（本文档）
- ✅ **Step 12**: MIT App Inventor 完整实现（本文档）

---

## 目录

1. [Step 11A：检测模块单独测试](#step-11a检测模块单独测试)
2. [Step 11B：腕带模块单独测试](#step-11b腕带模块单独测试)
3. [Step 12：MIT App Inventor 完整实现](#step-12mit-app-inventor-完整实现)
4. [测试记录表](#测试记录表)
5. [快速参考](#快速参考)

---

# Step 11A：检测模块单独测试

## 【测试1】系统启动与初始化

**预期串口日志：**
```
[INIT] I2C...
[INIT] SnO2...
    ✓ SnO2 ready
[INIT] SensorCollector...
    ✓ SensorCollector ready
✓ 系统初始化完成！
```

**测试结果：** ☐ Pass ☐ Fail

---

## 【测试2】SnO2加热PWM占空比测试

| 参数 | 预期值 | 实际值 |
|------|--------|--------|
| PWM频率 | 1000 Hz | ____ |
| 占空比 | 70-80% | ____ |
| 加热周期 | 40秒 | ____ |
| 加热持续时间 | 8秒 | ____ |

---

## 【测试3】AD623输出电压范围

| 条件 | 预期范围 | 实际值 |
|------|---------|--------|
| 环境基线 | 800-1200mV | ____ |
| 噪声水平 | ±40mV | ____ |
| 采样频率 | 100ms | ____ |

---

## 【测试4】电池电压读数

| 电量百分比 | 预期电压 | 实际值 |
|-----------|---------|--------|
| 100% | 4100-4200mV | ____ |
| 50% | 3600-3700mV | ____ |
| 20% | 3300-3400mV | ____ |

---

# Step 11B：腕带模块单独测试

## 【测试1】MAX30102心率+血氧输出

**预期串口日志：**
```
[HR] R:98765 IR:123456 (cnt:50)
[ALG RESULT] BPM:72 SpO2:98 Corrected:73 SQ:85
```

| 项目 | 预期 | 实际 |
|------|------|------|
| BPM范围 | 50-110 | ____ |
| SpO2范围 | 95-99% | ____ |
| 信号质量 | ≥70% | ____ |

---

## 【测试2】AMOLED屏幕刷新

| 显示项 | 刷新频率 | 实际频率 |
|--------|----------|----------|
| 心率值 | 2次/秒 | ____ |
| 血氧值 | 2次/秒 | ____ |
| 电池 | 60s一次 | ____ |

---

## 【测试3】按键响应

| 操作 | 预期响应 | 延迟 | 实际 |
|------|---------|------|------|
| 短按 | 屏幕刷新 | <200ms | ____ |
| 长按(2s) | 进入配对 | 2-3s | ____ |

---

# Step 12：MIT App Inventor 完整实现

见上文详细描述中的Module 1-6。

---

# 测试记录表

## 检测模块测试总结

| 项目 | ☐ Pass | ☐ Fail | 日期 | 签名 |
|------|--------|--------|------|------|
| 初始化 | ☐ | ☐ | __/__/__ | ____ |
| SnO2加热 | ☐ | ☐ | __/__/__ | ____ |
| AD623读数 | ☐ | ☐ | __/__/__ | ____ |
| 电池监测 | ☐ | ☐ | __/__/__ | ____ |
| **总体评价** |**☐ PASS**|**☐ FAIL**| __/__/__ | ____ |

## 腕带模块测试总结

| 项目 | ☐ Pass | ☐ Fail | 日期 | 签名 |
|------|--------|--------|------|------|
| HR/SpO2 | ☐ | ☐ | __/__/__ | ____ |
| AMOLED屏幕 | ☐ | ☐ | __/__/__ | ____ |
| 按键 | ☐ | ☐ | __/__/__ | ____ |
| BLE连接 | ☐ | ☐ | __/__/__ | ____ |
| **总体评价** |**☐ PASS**|**☐ FAIL**| __/__/__ | ____ |

---

# 快速参考

## 常见问题排查

### MAX30102初始化失败
- 检查GPIO17/18连接
- 验证4.7K上拉电阻
- 用i2c_scanner扫描地址0x57

### SnO2值异常
- 检查GPIO1 ADC连接
- 测量AD623输出电压
- 核实RC滤波电容值

### BLE连接失败
- 确认NimBLE库已安装
- 检查UUID是否正确
- 重新烧录固件

---

## 联系支持

如遇到问题，请检查以下资源：
1. 串口日志输出
2. 硬件连接图
3. 引脚配置文件

---

**文档生成日期：** 2026-02-18
**系统版本：** v1.0-Final
**状态：** 完成 ✓

